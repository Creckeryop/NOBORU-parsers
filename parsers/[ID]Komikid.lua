Komikid=Parser:new("Komikid","https://www.komikid.com","IDN","KOMIKIDIDN",3)Komikid.Tags={"Action","Adventure","Comedy","Doujinshi","Drama","Fantasy","Gender Bender","Historical","Horror","Josei","Martial Arts","Mature","Mecha","Mystery","One Shot","Psychological","Romance","School Life","Sci-fi","Seinen","Shoujo","Shoujo Ai","Shounen","Shounen Ai","Slice of Life","Sports","Supernatural","Tragedy","Yaoi","Yuri"}Komikid.TagValues={["Action"]=1,["Adventure"]=2,["Comedy"]=3,["Doujinshi"]=4,["Drama"]=5,["Fantasy"]=7,["Gender Bender"]=8,["Historical"]=10,["Horror"]=11,["Josei"]=12,["Martial Arts"]=13,["Mature"]=14,["Mecha"]=15,["Mystery"]=16,["One Shot"]=17,["Psychological"]=18,["Romance"]=19,["School Life"]=20,["Sci-fi"]=21,["Seinen"]=22,["Shoujo"]=23,["Shoujo Ai"]=24,["Shounen"]=25,["Shounen Ai"]=26,["Slice of Life"]=27,["Sports"]=28,["Supernatural"]=29,["Tragedy"]=30,["Yaoi"]=31,["Yuri"]=32}Komikid.Letters={"#","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"}local function a(b)return b:gsub("&#([^;]-);",function(c)local d=tonumber("0"..c)or tonumber(c)return d and u8c(d)or"&#"..c..";"end):gsub("&(.-);",function(c)return HTML_entities and HTML_entities[c]and u8c(HTML_entities[c])or"&"..c..";"end)end;local function e(b)return b:gsub("\\u(....)",function(c)return u8c(tonumber("0x"..c))end)end;local function f(g)local h={}Threads.insertTask(h,{Type="StringRequest",Link=g,Table=h,Index="text"})while Threads.check(h)do coroutine.yield(false)end;return h.text or""end;function Komikid:getManga(g,i)local j=f(g)i.NoPages=true;for k,l,m in j:gmatch('<a href="[^"]-/manga/([^"]-)"[^>]->[^>]-src=\'([^\']-)\' alt=\'([^\']-)\'>[^<]-</a>')do i[#i+1]=CreateManga(a(m),k,l,self.ID,self.Link.."/manga/"..k,self.Link.."/manga/"..k)i.NoPages=false;coroutine.yield(false)end end;function Komikid:getPopularManga(n,i)self:getManga(self.Link.."/filterList?sortBy=views&asc=false&page="..n,i)end;function Komikid:getAZManga(n,i)self:getManga(self.Link.."/filterList?sortBy=name&asc=true&page="..n,i)end;function Komikid:getLetterManga(n,i,o)self:getManga(self.Link.."/filterList?alpha="..o:gsub("#","Other").."&sortBy=name&asc=true&page="..n,i)end;function Komikid:getTagManga(n,i,p)self:getManga(self.Link.."/filterList?alpha=&cat="..(self.TagValues[p]or"0").."&sortBy=name&asc=true&page="..n,i)end;function Komikid:searchManga(q,n,i)local j=f(self.Link.."/search?query="..q)i.NoPages=true;for r,s in j:gmatch('{"value":"(.-)","data":"(.-)"}')do i[#i+1]=CreateManga(e(r),s,self.Link.."/uploads/manga/"..s.."/cover/cover_250x350.jpg",self.ID,self.Link.."/manga/"..s,self.Link.."/manga/"..s)coroutine.yield(false)end end;function Komikid:getChapters(t,i)local j=f(self.Link.."/manga/"..t.Link)local u=j:match('class="well">.-<p[^>]->(.-)</div>')or""i.Description=a(u:gsub("<.->",""):gsub("^%s+",""):gsub("%s+$",""))local v={}for k,m,w in j:gmatch('chapter%-title%-rtl">[^<]-<a href="[^"]-/manga/([^"]-)">([^<]-)</a>(.-)</h5>')do w=w:match("<em>([^<]-)</em>")v[#v+1]={Name=a(m..(w and": "..w or"")),Link=k,Pages={},Manga=t}end;for x=#v,1,-1 do i[#i+1]=v[x]end end;function Komikid:prepareChapter(y,i)local j=f(self.Link.."/manga/"..y.Link)for k in j:gmatch('img%-responsive"[^>]-data%-src=\' ([^\']-) \'')do i[#i+1]=k end end;function Komikid:loadChapterPage(g,i)i.Link=g end